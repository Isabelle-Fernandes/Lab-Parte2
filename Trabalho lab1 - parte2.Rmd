---
title: 'Relatório: 2ª Rodada Laboratório 1'
author: "Joaquim e Isabelle"
date: "10-11-2023"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, echo = TRUE, message = FALSE)
```

```{r, include=FALSE}

#Pacotes utilizados

# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggridges")
# install.packages("scales")
# install.packages("gmodels")
# install.packages("ggplot2")
# install.packages("caret")
# install.packages("leaps")
# install.packages("MASS")
# install.packages("dplyr")
# install.packages("reshape2")
# install.packages("ggridges")
# install.packages("kableExtra")
# install.packages("formattable")


library(ggplot2)
library(caret)
library(leaps)
library(MASS)
library(dplyr)
library(readxl)
library(tidyverse)
library(reshape2)
library(ggridges)
library(scales)
library(gmodels)
library(tidyr)
library(knitr)
library(magrittr)
# library(kableExtra)
library(formattable)
```
\newpage

# 1. Introdução

<div style="text-align: justify">

<div/>

## 1.1 Objetivos Gerais do estudo

<div style="text-align: justify">
Compreender a motivação dos turistas para visitar determinada localidade influenciados pelo audiovisual.  
<div/>

## 1.2 Objetivos Específicos

<div style="text-align: justify">
- Fazer uma análise por grupo de entrevistados; 
- fazer uma análise estatística da pesquisa.  
<div/>
\newpage

# 2 Metodologia

<div style="text-align: justify">

<div/>
\newpage

# 3 Resultados

<div style="text-align: justify">

<div/>

## 3.1 Análise exploratória - Estatísticas descritivas

```{r, echo = FALSE, include = FALSE}

#Leitura e organizacao dos dados

banco <- read_excel("respostas.xlsx", sheet = "Respostas ao formulário 1")
banco <- as.data.frame(banco)

```


### Gráfico: Tipo de turista
```{r}
banco %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),1)) %>% 
  ggplot(aes(x=`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, y=Quantidade, 
           label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, ) +
  theme(plot.title=element_text(hjust = 0.5, size=11, face = "bold")) + 
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

### Gráfico: Consumo de produção audiovisual
```{r}
dado <- strsplit(banco$`7. Quais os tipos de produção audiovisual você mais gosta de assistir? Se necessário, marque mais de uma opção.`, ",")

dado <- str_trim(unlist(dado))

coluna <- unique(dado)
data <- data.frame(matrix(nrow = 1, ncol = 5))
colnames(data) = coluna

data <- data %>%
  mutate(Filmes = sum(dado == "Filmes")) %>% 
  mutate(Novelas = sum(dado == "Novelas")) %>% 
  mutate(Seriados = sum(dado == "Seriados")) %>% 
  mutate('Clipes de música' = sum(dado == "Clipes de música")) %>% 
  mutate(Outros = sum(dado == "Outros"))

data <- melt(data)

data %>% 
  mutate(Percentual = percent(value/sum(value),1)) %>% 
  ggplot(aes(x=reorder(variable, -value), y=value, label = Percentual)) + 
  geom_bar(stat = "identity", position = "dodge", fill ='#9cd1f0') +
  geom_label(position = position_dodge(width = 1), show.legend = F) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))

```

Entre os que citaram "Outros", descreveram: documentários, curtas, propagandas criativas, produtores de conteúdo nas redes sociais.

### Gráfico: - Faixa etária dos respondentes
```{r}
banco %>% 
  group_by(`2. Faixa etária:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=`2. Faixa etária:`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,100,5)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))


```

### Gráfico: Nível de escolaridade dos respondentes
```{r}
banco %>% 
  group_by(`4. Nível de escolaridade concluído:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=`4. Nível de escolaridade concluído:`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,55,5)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10)) +
  theme(axis.text.x = element_text(angle = -20, vjust = 0.5, hjust=0.5))
```


### Gráfico: Região do Brasil onde os respondentes residem
```{r}
banco %>% 
  group_by(`5. Em qual região do Brasil você reside atualmente?`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=`5. Em qual região do Brasil você reside atualmente?`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,55,5)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10)) +
  theme(axis.text.x = element_text(angle = -20, vjust = 0.5, hjust=0.5))
```


### Gráfico: Respondente assina alguma plataforma de streaming
```{r}
banco %>% 
  group_by(`9. Você assina alguma plataforma de streaming como Netflix, Amazon Prime, Globo Play, etc.?`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  na.omit(df) %>% 
  ggplot(aes(x=`9. Você assina alguma plataforma de streaming como Netflix, Amazon Prime, Globo Play, etc.?`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,115,10)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

Plataforma de streaming: Netflix, Amazon Prime, Globo Play, etc.


### Gráfico: Os locais retratados na produção audiovisual estavam de acordo com o local visitado
```{r}
banco %>% 
  group_by(`19. Na sua percepção, os locais retratados na produção audiovisual estavam de acordo com o que você presenciou no local visitado?`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  na.omit() %>% 
  ggplot(aes(x=`19. Na sua percepção, os locais retratados na produção audiovisual estavam de acordo com o que você presenciou no local visitado?`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,115,10)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```


### Gráfico: Nível de satisfação com a viagem induzida pelo audiovisual
```{r}
banco %>% 
  group_by(`22. Como você classificaria o seu nível de satisfação com a sua viagem induzida pelo audiovisual:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=reorder(`22. Como você classificaria o seu nível de satisfação com a sua viagem induzida pelo audiovisual:`, -Quantidade), y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,115,10)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

### Gráfico: Plataforma de streaming utilizada

```{r}
dado <- strsplit(banco$`10. Qual? Se necessário, marque mais de uma opção.`, ",")

dado <- str_trim(unlist(dado)) %>% 
  na.omit()

coluna <- unique(dado)
data <- data.frame(matrix(nrow = 1, ncol = 9))
colnames(data) = coluna

data <- data %>%
  mutate(Netflix = sum(dado == "Netflix")) %>% 
  mutate(Globoplay = sum(dado == "Globoplay")) %>% 
  mutate('Disney+' = sum(dado == "Disney+")) %>% 
  mutate('HBO Max' = sum(dado == "HBO Max")) %>% 
  mutate(Telecine = sum(dado == "Telecine")) %>% 
  mutate('Amazon Prime Vídeo' = sum(dado == "Amazon Prime Vídeo")) %>% 
  mutate('Star+' = sum(dado == 'Star+')) %>% 
  mutate(Outros = sum(dado == "Outros")) %>% 
  mutate(Viki = sum(dado == "Viki"))

data <- melt(data)

data %>% 
  mutate(Percentual = percent(value/sum(value),1)) %>% 
  ggplot(aes(x=reorder(variable, -value), y=value, label = Percentual)) + 
  geom_bar(stat = "identity", position = "dodge", fill ='#9cd1f0') +
  geom_label(position = position_dodge(width = 1), show.legend = F) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

Entre os que citaram "Outros", descreveram: Pluto TV, Apple TV, Hulu, My Família TV.

```{r}

```



### Gráfico: Sexo versus Tipo de turista
```{r}
banco %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, 
           `1. Qual foi o sexo atribuído no seu nascimento?`) %>% 
  summarise(Quantidade=n()) %>% 
  group_by(`1. Qual foi o sexo atribuído no seu nascimento?`) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),1)) %>% 
  ggplot(aes(x=`1. Qual foi o sexo atribuído no seu nascimento?`, y=Percentual, 
           fill=`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`,
           label = Percentual)) + 
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(name="Tipo turista", values=c('#9cd1f0','#368196',"#69b3a2")) +
  geom_label(position = position_dodge(width = 1), show.legend = F) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

### Gráfico: Sexo versus Tipo de turista

```{r}
banco %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, 
           `1. Qual foi o sexo atribuído no seu nascimento?`) %>% 
  summarise(Quantidade=n()) %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),1)) %>% 
  ggplot(aes(x=`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, y=Percentual, 
           fill=`1. Qual foi o sexo atribuído no seu nascimento?`, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge") +
  geom_label(position = position_dodge(width = 1), show.legend = F, ) +
  scale_fill_manual(name="Tipo turista", values=c('#9cd1f0','#368196',"#69b3a2")) +
  theme(plot.title=element_text(hjust = 0.5, size=11, face = "bold")) + 
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

