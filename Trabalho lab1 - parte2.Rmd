---
title: 'Relatório: 2ª Rodada Laboratório 1'
author: "Joaquim e Isabelle"
date: "17-11-2023"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, echo = TRUE, message = FALSE)
```

```{r, include=FALSE}

#Pacotes utilizados

# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggridges")
# install.packages("scales")
# install.packages("gmodels")
# install.packages("ggplot2")
# install.packages("caret")
# install.packages("leaps")
# install.packages("MASS")
# install.packages("dplyr")
# install.packages("reshape2")
# install.packages("ggridges")
# install.packages("kableExtra")
# install.packages("formattable")


library(ggplot2)
library(caret)
library(leaps)
library(MASS)
library(dplyr)
library(readxl)
library(tidyverse)
library(reshape2)
library(ggridges)
library(scales)
library(gmodels)
library(tidyr)
library(knitr)
library(magrittr)
# library(kableExtra)
library(formattable)
```
\newpage

# 1. Introdução

<div style="text-align: justify">

<div/>

## 1.1 Objetivos Gerais do estudo

<div style="text-align: justify">
Compreender a motivação dos turistas para visitar determinada localidade influenciados pelo audiovisual.  
<div/>

## 1.2 Objetivos Específicos

<div style="text-align: justify">
- Fazer uma análise por grupo de entrevistados; 
- fazer uma análise estatística da pesquisa.  
<div/>
\newpage

# 2 Metodologia

<div style="text-align: justify">

<div/>
\newpage

# 3 Resultados

<div style="text-align: justify">

<div/>

## 3.1 Análise exploratória - Estatísticas descritivas

```{r, echo = FALSE, include = FALSE}
#Leitura e organizacao dos dados

banco <- read_excel("respostas.xlsx", sheet = "Respostas ao formulário 1")
banco <- as.data.frame(banco)

banco_principais <- as.data.frame(banco[,c(3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21,23,24,26,28)])

```


```{r, echo = FALSE, include = FALSE}
names(banco_principais)[7] <- 'X'

# Vou separar a coluna 7 em outras colunas para podermos trabalhar melhor com os dados

# Funcao para checar se opcao foi marcada
check_option <- function(string, option) {
  options <- strsplit(string, ", ")[[1]]
  if (option %in% options) {
    return('1')
  } else {
    return('0')
  }
}

# Apply the function to each row and create new columns
banco_principais <- banco_principais %>%
  mutate(Filmes = sapply(X, check_option, option = "Filmes"),
         Novelas = sapply(X, check_option, option = "Novelas"),
         Seriados = sapply(X, check_option, option = "Seriados"),
         Clipes_de_musica = sapply(X, check_option, option = "Clipes de musica"),
         'Outro audiovisual' = sapply(X, check_option, option = "Outros"))

# Optionally, you can convert the new columns to factors
banco_principais[, c("Filmes", "Novelas", "Seriados", "Clipes_de_musica", "Outros")] <- lapply(banco_principais[, c("Filmes", "Novelas", "Seriados", "Clipes_de_musica", "Outro audiovisual")], as.factor)

#removendo a coluna que dava todos dados juntos
banco_principais <- subset(banco_principais, select = -X)

```

```{r, echo = FALSE, include = FALSE}
names(banco_principais)[9] <- 'X'

# Vou separar a coluna 7 em outras colunas para podermos trabalhar melhor com os dados

# Funcao para checar se opcao foi marcada
check_option <- function(string, option) {
  options <- strsplit(string, ", ")[[1]]
  if (option %in% options) {
    return(as.factor('1'))
  } else {
    return(as.factor('0'))
  }
}

# Apply the function to each row and create new columns
banco_principais <- banco_principais %>%
  mutate('Netflix' = sapply(X, check_option, option = "Netflix"),
         Globoplay = sapply(X, check_option, option = "Globoplay"),
         'Amazon Prime Vídeo' = sapply(X, check_option, option = "Amazon Prime Vídeo"),
         'HBO Max' = sapply(X, check_option, option = "HBO Max"),
         'Disney+' = sapply(X, check_option, option = "Disney+"),
         'Telecine' = sapply(X, check_option, option = "Telecine"),
         'Star+' = sapply(X, check_option, option = "Star+"),
         Viki = sapply(X, check_option, option = "Viki"),
         'Outros streamig' = sapply(X, check_option, option = "Outros"))
         

#removendo a coluna que dava todos dados juntos
banco_principais <- subset(banco_principais, select = -X)
```

```{r, echo = FALSE, include = FALSE}
names(banco_principais)[12] <- 'X'

check_option <- function(string, option) {
  options <- strsplit(gsub("\\., ", "--",string), "--")[[1]]
  if (option %in% options) {
    return(as.factor('1'))
  } else {
    return(as.factor('0'))
  }
}

# Apply the function to each row and create new columns

banco_principais <- banco_principais %>% 
  mutate("Conhecer lugares retratados nas telas, incluindo cenários, paisagens, clima, culturas, etc" = sapply(X, check_option, option = "Conhecer lugares retratados nas telas, incluindo cenários, paisagens, clima, culturas, etc."),
         "Outra motivação" = sapply(X, check_option, option = "Outros"),
         "Outros (Audiovisual)" = sapply(X, check_option, option = "Outros (Audiovisual)"),
         "Obter mais informações sobre o filme: enredo, trama, gênero, etc" = sapply(X, check_option, option = "Obter mais informações sobre o filme: enredo, trama, gênero, etc."),
         "Conhecer personagens (Celebridades)" = sapply(X, check_option, option = "Conhecer personagens (Celebridades)"))
        
#removendo a coluna que dava todos dados juntos
banco_principais <- subset(banco_principais, select = -X)
```

```{r, echo = FALSE, include = FALSE}
names(banco_principais)[13] <- 'X'

check_option <- function(string, option) {
  options <- strsplit(gsub("\\., ", "--",string), "--")[[1]]
  if (option %in% options) {
    return(as.factor('1'))
  } else {
    return(as.factor('0'))
  }
}

# Apply the function to each row and create new columns

banco_principais <- banco_principais %>% 
  mutate("Visita a parques, praças e espaços na natureza exibidos na tela" = sapply(X, check_option, option = "Visita a parques, praças e espaços na natureza exibidos na tela"),
         "Visita a Parques temáticos baseados em atrações inspiradas em séries, filmes, etc" = sapply(X, check_option, option = "Visita a Parques temáticos baseados em atrações inspiradas em séries, filmes, etc"),
         "Visita a cenários internos ou externos onde foram filmadas" = sapply(X, check_option, option = "Visita a cenários internos ou externos onde foram filmadas"),
         "Desfrute da gastronomia retratada na tela, incluindo alimentos e bebidas" = sapply(X, check_option, option = "Desfrute da gastronomia retratada na tela, incluindo alimentos e bebidas"),
         "Participação em eventos relacionados a filmes" = sapply(X, check_option, option = "Participação em eventos relacionados a filmes"),
         "Visita a estabelecimentos exibidos na tela, como bares, restaurantes e outros" = sapply(X, check_option, option = "Visita a estabelecimentos exibidos na tela, como bares, restaurantes e outros"),
         "Realização de roteiros guiados em locais de filmagem" = sapply(X, check_option, option = "Realização de roteiros guiados em locais de filmagem"),
         "Outra atividade" = sapply(X, check_option, option = "Outros"),
         "Visita a patrimônios culturais exibidos na tela" = sapply(X, check_option, option = "Visita a patrimônios culturais exibidos na tela"))

#removendo a coluna que dava todos dados juntos
banco_principais <- subset(banco_principais, select = -X)
```

```{r, echo = FALSE, include = FALSE}
names(banco_principais)[13] <- 'X'

#a <- strsplit(banco_principais$X,", ")
#unique(unlist(a))

check_option <- function(string, option) {
  options <- strsplit(gsub("\\., ", "--",string), "--")[[1]]
  if (option %in% options) {
    return(as.factor('1'))
  } else {
    return(as.factor('0'))
  }
}

# Apply the function to each row and create new columns

banco_principais <- banco_principais %>% 
  mutate(Nostalgia = sapply(X, check_option, option = "Nostalgia"),
         Autorrealização = sapply(X, check_option, option = "Autorrealização"),
         "Escapismo da realidade" = sapply(X, check_option, option = "Escapismo da realidade"),
         Fantasia = sapply(X, check_option, option = "Fantasia"),
         Encantamento = sapply(X, check_option, option = "Encantamento"),
         Romance = sapply(X, check_option, option = "Romance"),
         "Superação de desafios" = sapply(X, check_option, option = "Superação de desafios"),
         "Outro sentimento" = sapply(X, check_option, option = "Outros"))

#removendo a coluna que dava todos dados juntos
banco_principais <- subset(banco_principais, select = -X)
```

```{r}
# banco_principais[14] é "21. Com quem você viajou?"

# unique(banco_principais[14])

for (i in 1:117) {
  if(banco_principais[i,14] %in% c("Colegas","Ex namorado","Amigos e namorado.","Marido e outros familiares", "Sozinha ou com amigos e/ou familiares")){
    banco_principais[i,14] = 'Outros'
  }
}


```


### Gráfico: Tipo de turista
```{r}
banco %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),1)) %>% 
  ggplot(aes(x=`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, y=Quantidade, 
           label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, ) +
  theme(plot.title=element_text(hjust = 0.5, size=11, face = "bold")) + 
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

### Gráfico: Consumo de produção audiovisual
```{r}
dado <- strsplit(banco$`7. Quais os tipos de produção audiovisual você mais gosta de assistir? Se necessário, marque mais de uma opção.`, ",")

dado <- str_trim(unlist(dado))

coluna <- unique(dado)
data <- data.frame(matrix(nrow = 1, ncol = 5))
colnames(data) = coluna

data <- data %>%
  mutate(Filmes = sum(dado == "Filmes")) %>% 
  mutate(Novelas = sum(dado == "Novelas")) %>% 
  mutate(Seriados = sum(dado == "Seriados")) %>% 
  mutate('Clipes de música' = sum(dado == "Clipes de música")) %>% 
  mutate(Outros = sum(dado == "Outros"))

data <- melt(data)

data %>% 
  mutate(Percentual = percent(value/sum(value),1)) %>% 
  ggplot(aes(x=reorder(variable, -value), y=value, label = Percentual)) + 
  geom_bar(stat = "identity", position = "dodge", fill ='#9cd1f0') +
  geom_label(position = position_dodge(width = 1), show.legend = F) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))

```

Entre os que citaram "Outros", descreveram: documentários, curtas, propagandas criativas, produtores de conteúdo nas redes sociais.

### Gráfico: - Faixa etária dos respondentes
```{r}
banco %>% 
  group_by(`2. Faixa etária:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=`2. Faixa etária:`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,100,5)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))


```

### Gráfico: Nível de escolaridade dos respondentes
```{r}
banco %>% 
  group_by(`4. Nível de escolaridade concluído:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=`4. Nível de escolaridade concluído:`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,55,5)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10)) +
  theme(axis.text.x = element_text(angle = -20, vjust = 0.5, hjust=0.5))
```


### Gráfico: Região do Brasil onde os respondentes residem
```{r}
banco %>% 
  group_by(`5. Em qual região do Brasil você reside atualmente?`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=`5. Em qual região do Brasil você reside atualmente?`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,55,5)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10)) +
  theme(axis.text.x = element_text(angle = -20, vjust = 0.5, hjust=0.5))
```


### Gráfico: Respondente assina alguma plataforma de streaming
```{r}
banco %>% 
  group_by(`9. Você assina alguma plataforma de streaming como Netflix, Amazon Prime, Globo Play, etc.?`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  na.omit(df) %>% 
  ggplot(aes(x=`9. Você assina alguma plataforma de streaming como Netflix, Amazon Prime, Globo Play, etc.?`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,115,10)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

Plataforma de streaming: Netflix, Amazon Prime, Globo Play, etc.


### Gráfico: Os locais retratados na produção audiovisual estavam de acordo com o local visitado
```{r}
banco %>% 
  group_by(`19. Na sua percepção, os locais retratados na produção audiovisual estavam de acordo com o que você presenciou no local visitado?`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  na.omit() %>% 
  ggplot(aes(x=`19. Na sua percepção, os locais retratados na produção audiovisual estavam de acordo com o que você presenciou no local visitado?`, y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,115,10)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```


### Gráfico: Nível de satisfação com a viagem induzida pelo audiovisual
```{r}
banco %>% 
  group_by(`22. Como você classificaria o seu nível de satisfação com a sua viagem induzida pelo audiovisual:`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>% 
  ggplot(aes(x=reorder(`22. Como você classificaria o seu nível de satisfação com a sua viagem induzida pelo audiovisual:`, -Quantidade), y=Quantidade, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge", fill="#9cd1f0") +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  scale_y_continuous(breaks = seq(0,115,10)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

### Gráfico: Plataforma de streaming utilizada

```{r}
dado <- strsplit(banco$`10. Qual? Se necessário, marque mais de uma opção.`, ",")

dado <- str_trim(unlist(dado)) %>% 
  na.omit()

coluna <- unique(dado)
data <- data.frame(matrix(nrow = 1, ncol = 9))
colnames(data) = coluna

data <- data %>%
  mutate(Netflix = sum(dado == "Netflix")) %>% 
  mutate(Globoplay = sum(dado == "Globoplay")) %>% 
  mutate('Disney+' = sum(dado == "Disney+")) %>% 
  mutate('HBO Max' = sum(dado == "HBO Max")) %>% 
  mutate(Telecine = sum(dado == "Telecine")) %>% 
  mutate('Amazon Prime Vídeo' = sum(dado == "Amazon Prime Vídeo")) %>% 
  mutate('Star+' = sum(dado == 'Star+')) %>% 
  mutate(Outros = sum(dado == "Outros")) %>% 
  mutate(Viki = sum(dado == "Viki"))

data <- melt(data)

data %>% 
  mutate(Percentual = percent(value/sum(value),1)) %>% 
  ggplot(aes(x=reorder(variable, -value), y=value, label = Percentual)) + 
  geom_bar(stat = "identity", position = "dodge", fill ='#9cd1f0') +
  geom_label(position = position_dodge(width = 1), show.legend = F) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

Entre os que citaram "Outros", descreveram: Pluto TV, Apple TV, Hulu, My Família TV.

```{r}
banco %>% 
  group_by(`14. Qual foi a sua principal motivação para realizar essa viagem relacionada com o audiovisual?`) %>% 
  summarise(Quantidade=n()) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),0)) %>%
  na.omit() %>% 
  ggplot(aes(x=reorder(`14. Qual foi a sua principal motivação para realizar essa viagem relacionada com o audiovisual?`, -Quantidade), y=Quantidade, label = Percentual, fill = reorder(`14. Qual foi a sua principal motivação para realizar essa viagem relacionada com o audiovisual?`, -Quantidade))) + 
  geom_bar(stat = "identity") +
  scale_fill_manual(name="Motivação da viagem", values=c('#368142','#368196',"#69b3a2", "#69b3e2", "#01d8a2")) +
  geom_label(position = position_dodge(width = 1), show.legend = F, size=3) +
  labs(x = NULL) +
  scale_y_continuous(breaks = seq(0,115,10)) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.text.x = element_blank()) +
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10)) +
  theme(legend.position = c(0.6, 0.75))

```



### Gráfico: Sexo versus Tipo de turista
```{r}
banco %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, 
           `1. Qual foi o sexo atribuído no seu nascimento?`) %>% 
  summarise(Quantidade=n()) %>% 
  group_by(`1. Qual foi o sexo atribuído no seu nascimento?`) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),1)) %>% 
  ggplot(aes(x=`1. Qual foi o sexo atribuído no seu nascimento?`, y=Percentual, 
           fill=`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`,
           label = Percentual)) + 
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(name="Tipo turista", values=c('#9cd1f0','#368196',"#69b3a2")) +
  geom_label(position = position_dodge(width = 1), show.legend = F) +
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```

### Gráfico: Sexo versus Tipo de turista

```{r}
banco %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, 
           `1. Qual foi o sexo atribuído no seu nascimento?`) %>% 
  summarise(Quantidade=n()) %>% 
  group_by(`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`) %>% 
  mutate(Percentual = percent(Quantidade/sum(Quantidade),1)) %>% 
  ggplot(aes(x=`12. A experiência turística e/ou cinematográfica vivida neste destino foi:`, y=Percentual, 
           fill=`1. Qual foi o sexo atribuído no seu nascimento?`, label = Percentual)) + 
  geom_bar(stat = "identity",position = "dodge") +
  geom_label(position = position_dodge(width = 1), show.legend = F, ) +
  scale_fill_manual(name="Tipo turista", values=c('#9cd1f0','#368196',"#69b3a2")) +
  theme(plot.title=element_text(hjust = 0.5, size=11, face = "bold")) + 
  theme_light() +
  theme(axis.title.y = element_blank()) + 
  theme(axis.title.x = element_blank()) +
  theme(legend.title = element_text(size = 10))
```






```{r, echo = FALSE, include = FALSE}
names(banco_principais) <- c('Sexo', 'Idade', 'Profissao', 'Escolaridade', 'Regiao_residencia',
                             'Cidade', 'Frequencia_audiovisuais', 'Streaming', 'Destino_viagem',
                             'Experiencia', 'Producao', 'Motivacao', 'Finalidade', 'Lazer',
                             'Sentimentos', 'Fidedigno', 'Companhia', 'Satisfacao', 'Expectativas',
                             'Repetiria',"Filmes", "Novelas", "Seriados", "Clipes_de_musica")
```